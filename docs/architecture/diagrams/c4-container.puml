@startuml Zenith Tasks - Container Diagram
!include https://raw.githubusercontent.com/plantuml-stdlib/C4-PlantUML/master/C4_Container.puml

LAYOUT_WITH_LEGEND()

title Container Diagram - Zenith Tasks

Person(user, "Usuário")

System_Boundary(zenith_boundary, "Zenith Tasks Application") {
    Container(web_app, "Web Application", "Next.js 15, React 18", "Interface do usuário com Server/Client Components")
    Container(api_routes, "API Routes", "Next.js API, TypeScript", "Endpoints REST para operações do sistema")
    Container(ai_service, "AI Service Layer", "AI SDK 5.0, TypeScript", "Abstração para provedores de IA")
    Container(mcp_client, "MCP Client", "TypeScript", "Cliente para comunicação com servidores MCP")
    Container(db_service, "Database Service", "Supabase Client", "Abstração para operações no banco")
}

ContainerDb(postgres, "PostgreSQL Database", "Supabase", "Armazena itens, subtarefas, configurações")
ContainerDb(redis_cache, "Redis Cache", "Upstash Redis (opcional)", "Cache de servidores MCP")

System_Ext(gemini_api, "Gemini API")
System_Ext(clerk_api, "Clerk API")
System_Ext(mcp_ext, "MCP Servers")

Rel(user, web_app, "Interage via navegador", "HTTPS")
Rel(web_app, api_routes, "Faz requests", "HTTP/JSON")
Rel(api_routes, ai_service, "Usa", "Function calls")
Rel(api_routes, mcp_client, "Usa", "Function calls")
Rel(api_routes, db_service, "Usa", "Function calls")

Rel(ai_service, gemini_api, "Envia prompts", "HTTPS/JSON + Streaming")
Rel(mcp_client, mcp_ext, "Executa tools", "HTTPS/MCP Protocol")
Rel(db_service, postgres, "Query/atualiza", "PostgREST + Realtime")
Rel(mcp_client, redis_cache, "Cache servers", "Redis Protocol")

Rel(web_app, clerk_api, "Autentica", "HTTPS/JWT")
Rel(api_routes, clerk_api, "Valida tokens", "HTTPS")

@enduml
